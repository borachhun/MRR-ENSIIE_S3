---
title: "Practical session - Modèles de régression linéaire"
author: "Piseth KHENG, Borachhun YOU"
date: "19 September 2022"
output: pdf_document
---

```{r, echo=FALSE}
rm(list=ls()); graphics.off()
```

# IV. Application: GAFAM or BATX dataset

The data set below shows the number of monthly active users (MAU) on Facebook from 2008 to 2021 in millions (*source: https://www.statista.com/statistics/264810/number-of-monthly-active-facebook-users-worldwide/*). The numbers were taken from Q4 of each year except for the year 2008, whose data is only available in Q3.

```{r}
tab <- read.table("fb_mau.txt", header=TRUE, sep=",")
tab
```

The dimension of the data set:

```{r}
dim(tab)
```

We then try visualizing the data in order to see if there is an apparent linear relationship between the year and the number of users.

```{r}
plot(tab, xlab="Year", ylab="Monthly active users")
```

Based on the plotted graph above, we can see that the relationship is fairly linear. Therefore, we can use a linear model to represent the relationship.

```{r}
modreg = lm(mau ~ year, data=tab)
summary(modreg)
```

According to the summary of the model, the estimated intercept equals $-4.330 \times 10^5$ and the estimated coefficient of the year variable equals $2.157 \times 10^2$. The model can be written in the form:

$$\hat{MAU} = (-4.330 \times 10^5) + (2.157 \times 10^2) year$$

As for the $R^2$, we can see that $R^2 = 0.9979 \approx 1$. It is a great result since the value corresponds to the cosinus of the angle between the vector of predictions and the vector of the target values, and the closer to 0 the angle gets, the better the model becomes.

```{r}
Y <- tab$mau
Y_predict <- predict(modreg, tab)

plot(Y, Y_predict)
grid()
abline(a=0, b=1, col="red")
```

In the graph $(MAU, \hat{MAU})$ above, we can see that the plotted points are fairly close to the bisector???

```{r}
epsilon <- Y - Y_predict
plot(epsilon)
grid()
abline(a=0, b=0, col="red")
```

# V. Medical data

```{r}
tab <- read.table("diabetes.txt", header=TRUE, sep="\t")

modreg = lm(Y~., data=tab)
summary(modreg)
```

```{r}
Y <- tab$Y
Y_predict <- predict(modreg, tab)
plot(Y, Y_predict)
grid()
abline(a=0, b=1)
```

```{r}
epsilon <- Y - Y_predict
plot(epsilon)
grid()
```