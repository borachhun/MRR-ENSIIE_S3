rm(list=ls()); graphics.off()
tab <- read.table("diabetes.txt", header=TRUE, sep="\t")
head(tab)
?step
?lm
rm(list=ls()); graphics.off()
tab <- read.table("diabetes.txt", header=TRUE, sep="\t")
head(tab)
reg = lm(Y~., data=tab)
summary(reg)
Y <- tab$Y
Y_predict <- predict(reg, tab)
plot(Y, Y_predict, col="blue", pch=20, main="Observed and predicted values")
grid()
abline(a=0, b=1, col="red")
regbackward = step(reg, direction="backward")
summary(regbackward)
Y_backward <- predict(regbackward, tab)
plot(Y, Y_backward, col="blue", pch=20, main="Observed and predicted values of backward regression")
grid()
abline(a=0, b=1, col="red")
regforward = step(lm(Y~1, data=tab), list(upper=reg), direction="forward")
summary(regforward)
Y_forward <- predict(regforward, tab)
plot(Y, Y_forward, col="blue", pch=20, main="Observed and predicted values of forward regression")
grid()
abline(a=0, b=1, col="red")
regboth = step(reg, direction="both")
summary(regboth)
Y_both <- predict(regboth, tab)
plot(Y, Y_both, col="blue", pch=20, main="Observed and predicted values of stepwise regression")
grid()
abline(a=0, b=1, col="red")
