rm(list=ls()); graphics.off()
tab <- read.table("diabetes.txt", header=TRUE, sep="\t")
head(tab)
?step
?lm
rm(list=ls()); graphics.off()
tab <- read.table("diabetes.txt", header=TRUE, sep="\t")
head(tab)
reg = lm(Y~., data=tab)
summary(reg)
Y <- tab$Y
Y_predict <- predict(reg, tab)
plot(Y, Y_predict, col="blue", pch=20, main="Observed and predicted values")
grid()
abline(a=0, b=1, col="red")
regbackward = step(reg, direction="backward")
summary(regbackward)
Y_backward <- predict(regbackward, tab)
plot(Y, Y_backward, col="blue", pch=20, main="Observed and predicted values of backward regression")
grid()
abline(a=0, b=1, col="red")
regforward = step(lm(Y~1, data=tab), list(upper=reg), direction="forward")
summary(regforward)
Y_forward <- predict(regforward, tab)
plot(Y, Y_forward, col="blue", pch=20, main="Observed and predicted values of forward regression")
grid()
abline(a=0, b=1, col="red")
regboth = step(reg, direction="both")
summary(regboth)
Y_both <- predict(regboth, tab)
plot(Y, Y_both, col="blue", pch=20, main="Observed and predicted values of stepwise regression")
grid()
abline(a=0, b=1, col="red")
?lm.ridge
library(MASS)
?lm.ridge
scaled_tab <- scale(tab)
library(MASS)
resridge = lm.ridge(Y~., data=scaled_tab)
library(MASS)
resridge = lm.ridge(Y~., data=scaled_tab, lambda=0)
library(MASS)
resridge = lm.ridge(Y~., data=tab)
scaled_tab <- scale(tab)
scaled_tab
typeof(tab)
typeof(scaled_tab)
library(MASS)
resridge = lm.ridge(Y~., data=tab)
library(MASS)
resridge = lm.ridge(Y~., data=scaled_tab)
scaled_tab <- as.data.frame(scale(tab))
scaled_tab
library(MASS)
resridge = lm.ridge(Y~., data=scaled_tab)
library(MASS)
rm(list=ls()); graphics.off()
tab <- read.table("diabetes.txt", header=TRUE, sep="\t")
head(tab)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge$GCV)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
plot(resridge)
plot(resridge)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
legend()
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
legend(x="topright")
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
plot(resridge$GCV)
?lm.ridge
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
plot(x=resridge$GCV, y=resridge$GCV)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge)
plot(x=resridge$lambda, y=resridge$GCV)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,20,0.01))
#plot(x=resridge$lambda, y=resridge$GCV)
plot(resridge$GCV)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,15,0.01))
#plot(x=resridge$lambda, y=resridge$GCV)
plot(resridge$GCV)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge$lambda, resridge$GCV)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge$lambda, resridge$GCV, pch=20)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.001))
plot(resridge$lambda, resridge$GCV, pch=20)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge$lambda, resridge$GCV, pch=19)
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge$lambda, resridge$GCV, pch=20)
F
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge$lambda, resridge$GCV, pch=20)
select(resridge)
?select
?select
?which.min
library(MASS)
resridge = lm.ridge(Y~., data=tab, lambda=seq(0,10,0.01))
plot(resridge$lambda, resridge$GCV, pch=20)
select(resridge)
resridge = lm.ridge(Y~., data=tab, lambda=3.24)
summary(resridge)
